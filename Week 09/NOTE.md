# 学习笔记

* HTML标准定义了解析HTML所需的状态机的完整状态和状态转移规则[HTML Tokenization](https://html.spec.whatwg.org/multipage/parsing.html#tokenization)，ToyBrowser选取其中较为重要的一些状态来实现了基本的HTML解析，以生成DOM数据结构。
* 要让状态机在状态转换时触发事件来实现业务逻辑，在标签结束状态时提交生成的标签token。
* HTML属性值有单引号，双引号，无引号三种写法，因此需要区分较多状态进行处理。
* 在一个属性结束时，就可以把它附加到标签的token上。
* DOM树的构建过程使用的基本数据结构是栈，可以让子标签找到父一级，让结束标签匹配开始标签。
* 自封闭标签没有子一级节点，无需入栈。文本标签的处理也是类似流程。
* 遇到style标签时就先把它解析为CSS规则保存起来。当一个style规则加载时，应当对现有的节点计算一次CSS属性（ToyBrowser未进行实现），之后每创建一个DOM节点，都应将它与已加载的CSS规则进行一次匹配，计算它的CSS属性。
* CSS复合选择器需要拿最后一项去匹配当前节点，然后逐级向外匹配每个父级节点，组成复合选择器的每一个简单选择器都匹配到一个节点时，匹配成功。
* 选择器与元素匹配成功时，就会将对应的规则应用到匹配成功的元素上去，以形成ComputedStyle。
* 选择器是有优先级的，和当前元素匹配度越高的选择器会越优先应用到元素上，而匹配度更低的规则则无法覆盖匹配度更高的规则。决定选择器优先级的顺序是inline id class tag。
