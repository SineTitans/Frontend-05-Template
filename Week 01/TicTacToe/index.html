<!DOCTYPE html>
<html>

<head>
    <style>
        .cell {
            width: 100px;
            height: 100px;
            background-color: green;
            display: inline-block;
            border: solid 1px white;
            vertical-align: middle;

            line-height: 100px;
            font-size: 50px;
            text-align: center;
        }
    </style>
    <script type="module">
        import { GameControl, MoveResult } from './src/game.js';
        let game = new GameControl;
        let boardView = [];

        function createBoard(board) {
            board.innerHTML = "";
            for (let i = 0; i < 3; ++i) {
                boardView[i] = [];
                for (let j = 0; j < 3; ++j) {
                    let cell = document.createElement("div");
                    cell.classList.add("cell");
                    cell.innerText = "";
                    cell.addEventListener("click", () => move(j, i));
                    board.appendChild(cell);
                    boardView[i][j] = cell;
                }
                board.appendChild(document.createElement("br"));
            }
        }

        let board = document.getElementById("board");
        createBoard(board);

        function show(pattern) {
            for (let i = 0; i < 3; ++i) {
                for (let j = 0; j < 3; ++j) {
                    let cell = boardView[i][j];
                    cell.innerText = pattern[i][j] === 2 ? "❌" :
                        pattern[i][j] === 1 ? "⭕" : "";
                }
            }
        }

        function move(x, y) {
            let res = game.move(x, y);
            if (res != MoveResult.CANTMOVE) {
                show(game.pattern.board);
                if (res == MoveResult.WIN) {
                    alert(game.color == 2 ? "❌ is winner!" : "⭕ is winner!");
                }
                else if (game.isWillWin()) {
                    console.log(game.color == 2 ? "❌ will win!" : "⭕ will win!");
                }
            }
        }

        show(game.pattern.board);
    </script>
</head>

<body>
    <div id="board"></div>
</body>

</html>